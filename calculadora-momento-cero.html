<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Calculadora – Momento Cero</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    :root{ --blue1:#00a7e0; --blue2:#0077c8; --blue3:#0057b8; --panel:#ffffff; --muted:#334155; --text:#0f172a; --line:#cfe3ff; }
    *{ box-sizing:border-box; }
    html,body{ height:100%; margin:0; }
    body{ font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial; background:linear-gradient(180deg,var(--blue1) 0%, var(--blue2) 52%, var(--blue3) 100%); color:var(--text); }
    .wrap{ max-width:1100px; margin:40px auto; padding:0 24px 36px; }
    .title{ font-size:32px; font-weight:800; color:#eaf6ff; text-shadow:0 3px 10px rgba(0,0,0,.25); }
    .grid{ display:grid; grid-template-columns: repeat(12,1fr); gap:18px; }
    .card{ background:linear-gradient(180deg,#f3f9ff 0%, #e3f1ff 100%); border:1px solid rgba(255,255,255,.7); border-radius:22px; padding:18px; }
    .card h3{ margin:0 0 10px; font-size:16px; font-weight:800; color:#0b1324; }
    label{ display:block; font-size:13px; margin-bottom:6px; }
    input[type=number]{ width:100%; padding:10px 12px; border-radius:12px; border:1px solid #b6d7ff; background:#ffffff; color:#0b1324; }
    .row{ display:grid; grid-template-columns:repeat(2,1fr); gap:12px; }
    .btns{ display:flex; gap:12px; align-items:center; flex-wrap:wrap; }
    button{ border:none; padding:10px 16px; border-radius:14px; font-weight:800; cursor:pointer; }
    .primary{ background:linear-gradient(180deg,#3b82f6,#2563eb); color:#f8fafc; }
    .ghost{ background:transparent; border:1px solid rgba(255,255,255,.75); color:#eaf6ff; }
    .success{ background:linear-gradient(180deg,#16a34a,#15803d); color:#f8fafc; }
    table{ width:100%; border-collapse:separate; border-spacing:0; margin-top:10px; border-radius:14px; }
    th, td{ padding:12px 14px; text-align:left; border-bottom:1px solid var(--line); font-size:14px; }
    th{ background:#e8f3ff; font-weight:800; }
    tfoot th{ background:#eaf4ff; }
    .right{ text-align:right; }
    @page { size: A4; margin: 14mm; }
    @media print { body{ background:#ffffff; } .btns{ display:none !important; } }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="title">Calculadora – Momento Cero</div>
    <div class="grid" style="margin-top:18px;">
      <div class="card" style="grid-column: span 5;">
        <h3>Devanado</h3>
        <div class="row">
          <div><label>Devanado 1/4</label><input id="dev14" type="number" value="0" /></div>
          <div><label>Devanado 1/2</label><input id="dev12" type="number" value="0" /></div>
        </div>
        <div class="row">
          <div><label>Devanado Total</label><input id="devTotal" type="number" value="0" /></div>
          <div><label>Tensor</label><input id="tensor" type="number" value="0" /></div>
        </div>
      </div>
      <div class="card" style="grid-column: span 7;">
        <h3>Cables</h3>
        <div class="grid" style="grid-template-columns: repeat(4, 1fr); gap:10px;">
          <div><label>1 cable</label><input id="cab1" type="number" value="0" /></div>
          <div><label>2 cables</label><input id="cab2" type="number" value="0" /></div>
          <div><label>3 cables</label><input id="cab3" type="number" value="0" /></div>
          <div><label>4 cables</label><input id="cab4" type="number" value="0" /></div>
        </div>
      </div>
      <div class="card" style="grid-column: span 12;">
        <h3>Unidades</h3>
        <div class="grid" style="grid-template-columns: repeat(6, 1fr); gap:10px;">
          <div><label>ACOMETIDAS</label><input id="acometidas" type="number" value="0" /></div>
          <div><label>CAJAS</label><input id="cajas" type="number" value="0" /></div>
          <div><label>ELEM. SEG.</label><input id="elemSeg" type="number" value="0" /></div>
          <div><label>PROTEC. SUB.</label><input id="protecSub" type="number" value="0" /></div>
          <div><label>CRUCE ELÉCTRICO</label><input id="cruceElec" type="number" value="0" /></div>
          <div><label>ARMARIO</label><input id="armario" type="number" value="0" /></div>
        </div>
      </div>
    </div>
    <div class="btns" style="margin-top:12px;">
      <button class="primary" onclick="calcular()">Calcular</button>
      <button class="ghost" onclick="limpiar()">Limpiar</button>
      <button id="btnPdf" class="success" onclick="exportarPDF()" disabled>Exportar PDF</button>
    </div>
    <div id="kpis" class="kpi" style="margin-top:14px; display:none;"></div>
    <div class="card" style="margin-top:14px;">
      <h3>Cuadro de cálculos</h3>
      <table id="tabla">
        <thead><tr><th>ELEMENTO</th><th>Unidad</th><th class="right">MOMENTO 0</th><th class="right">VALORAR</th><th class="right">Hs.L</th><th class="right">Hs.Lc</th></tr></thead>
        <tbody id="tbody"></tbody>
        <tfoot><tr><th colspan="4" class="right">Totales</th><th class="right" id="hsLTotal">0</th><th class="right" id="hsLcTotal">0</th></tr></tfoot>
      </table>
    </div>
  </div>
  <script>
    const HB = { C1:0.045, C2:0.200, C3:0.830, C4:0.700, C5:1.900, C6:0.500, C7:2.000 };
    const num = id => Math.max(0, Number(document.getElementById(id).value || 0));
    const fmt = v => (isNaN(v)? '0' : new Intl.NumberFormat('es-AR').format(v));
    const round2 = v => Math.round((v + Number.EPSILON) * 100) / 100;
    function limpiar(){ ['dev14','dev12','devTotal','tensor','cab1','cab2','cab3','cab4','acometidas','cajas','elemSeg','protecSub','cruceElec','armario'].forEach(id => document.getElementById(id).value = 0); document.getElementById('tbody').innerHTML = ''; document.getElementById('kpis').style.display = 'none'; document.getElementById('hsLTotal').textContent = '0'; document.getElementById('hsLcTotal').textContent = '0'; document.getElementById('btnPdf').disabled = true; }
    function calcular(){ const dev14=num('dev14'), dev12=num('dev12'), devT=num('devTotal'), tens=num('tensor'); const c1=num('cab1'), c2=num('cab2'), c3=num('cab3'), c4=num('cab4'); const acom=num('acometidas'), cajas=num('cajas'), eseg=num('elemSeg'), psub=num('protecSub'), cruce=num('cruceElec'), arma=num('armario'); const cantTramos=c1+c2+c3+c4; const mtsDevan=(dev14/4+dev12/2+devT)*50; const mtsTensor=tens*50; const mtsCobre=(c1+2*c2+3*c3+4*c4)*50; const filas=[]; filas.push({ elemento:'CABLES', unidad:'mts', m0:mtsCobre, val:cantTramos*50, hl:cantTramos*50*HB.C1, hlc:'' }); filas.push({ elemento:'SUSPENSOR', unidad:'mts', m0:mtsTensor, val:mtsTensor, hl:mtsTensor*HB.C1, hlc:'' }); filas.push({ elemento:'DEVANADO', unidad:'mts', m0:mtsDevan, val:mtsDevan, hl:mtsDevan*HB.C1, hlc:'' }); filas.push({ elemento:'ACOMETIDAS', unidad:'cant', m0:acom, val:acom, hl:acom*HB.C2, hlc:'' }); filas.push({ elemento:'ELEM SEG', unidad:'cant', m0:eseg, val:eseg, hl:eseg*(HB.C4/3), hlc:'' }); filas.push({ elemento:'CAJAS', unidad:'cant', m0:cajas, val:cajas, hl:cajas*HB.C3, hlc:'' }); filas.push({ elemento:'PROTEC. POS.', unidad:'cant', m0:psub, val:psub, hl:psub*HB.C6, hlc:'' }); filas.push({ elemento:'ARMARIO', unidad:'cant', m0:arma, val:arma, hl:arma*HB.C5, hlc:arma!==0?4.7:'' }); filas.push({ elemento:'CRUCE ELÉCTRICO', unidad:'cant', m0:cruce, val:cruce, hl:cruce*HB.C7, hlc:'' }); document.getElementById('kpis').innerHTML=`<div>CANT TRAMOS: ${fmt(cantTramos)}</div><div>MTS DEVAN: ${fmt(round2(mtsDevan))}</div><div>MTS TENSOR: ${fmt(round2(mtsTensor))}</div><div>MTS COBRE: ${fmt(round2(mtsCobre))}</div>`; document.getElementById('kpis').style.display='flex'; const tbody=document.getElementById('tbody'); tbody.innerHTML=''; let totalHL=0,totalHLc=0; filas.forEach(f=>{ const hl=round2(f.hl), hlc=(f.hlc===''?'':round2(f.hlc)); totalHL+=(isNaN(hl)?0:hl); totalHLc+=(hlc===''||isNaN(hlc)?0:hlc); tbody.innerHTML+=`<tr><td>${f.elemento}</td><td>${f.unidad}</td><td class="right">${fmt(round2(f.m0))}</td><td class="right">${fmt(round2(f.val))}</td><td class="right">${fmt(hl)}</td><td class="right">${hlc===''?'':fmt(hlc)}</td></tr>`; }); document.getElementById('hsLTotal').textContent=fmt(round2(totalHL)); document.getElementById('hsLcTotal').textContent=fmt(round2(totalHLc)); document.getElementById('btnPdf').disabled=false; }
    function exportarPDF(){ window.print(); }
  </script>
</body>
</html>
